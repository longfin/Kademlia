# DHT based on Kademlia

### 1. 카뎀리아

#### 	1.1 카뎀리아?

![img](https://t1.daumcdn.net/cfile/tistory/9902F23C5AFE48292A)

- 노드의 id값을 기반으로 거리를 계산해서, 먼 거리의 노드는 <b>간략하게</b>, 가까운 노드는 <b>자세하게</b> 라우팅 테이블에 저장하는 기법.

- 공통된 prefix의 길이를 `xor`로 계산하여 각각의 bucket에 저장.



#### 	1.2 Bootstrapping Procedure

1. 부트스트랩 노드의 정보는 하드코딩 되어(혹은 사용자가 직접 입력하여) 알고 있다.
2. 부트스트랩 노드에 자신과 거리가 가까운 몇 개의 노드를 요청한다.
3. 응답받은 노드에 대해 재귀적으로 보다 더 가까운 노드가 있는지 찾아본다.
4. 결과적으로 얻어낸 노드들을 자신의 라우팅 테이블에 집어넣는다.



#### 	1.3 Broadcasting Messages

1. 전송하는 노드는 자신의 라우팅 테이블의 각 bucket에서 하나씩 <i>랜덤하게</i> 뽑아 메세지 전달.
2. 메세지를 전달받은 노드들은 다시 자신의 라우팅 테이블에서 노드들을 골라 전달.
3. 메세지가 끝까지 도달할 때까지 반복.



---

### 2. 몇 가지 문제점

1. 동시에 엄청난 수의 노드가 죽어버리면 네트워크가 <b>분리</b>됨.
   	- 매우 극단적 상황으로 <i><u>거의</u></i> 일어나지 않음
2. 최초의 부트스트랩 단계에서 가까운 노드들을 가져오는 과정이 즉시 일어나지 않기 때문에 블럭을 생성했어도 네트워크와 연결되어 있지 않은 상태일 가능성이 있음.
3. 최초의 부트스트랩 단계를 성공적으로 완료했더라도 모든 노드들의 정보를 갖고 있지 않기 때문에 메세지 전송이 모든 노드에게 이뤄지지 않음.

